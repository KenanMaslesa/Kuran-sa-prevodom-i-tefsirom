<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Prijevod i tefsir</ion-title>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/quran/tabs/quran-template"></ion-back-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-icon slot="end" name="bookmark-outline" *ngIf="!bookmarksService.checkIsInTafsirBookmark(quranService.currentPage)" (click)="addTafsirBookmark(quranService.currentPage);quranService.showHeaderAndTabs=!quranService.showHeaderAndTabs"></ion-icon>
      <ion-icon slot="end" name="bookmark" *ngIf="bookmarksService.checkIsInTafsirBookmark(quranService.currentPage)" (click)="deleteTafsirBookmark(quranService.currentPage);quranService.showHeaderAndTabs=!quranService.showHeaderAndTabs"></ion-icon>
    </ion-buttons>
  </ion-toolbar>

  <ion-list style="padding: 0;">
    <ion-item>
      <ion-label>Arapski</ion-label>
      <ion-toggle [(ngModel)]="showArabic"></ion-toggle>

      <ion-label>Prijevod</ion-label>
      <ion-toggle [(ngModel)]="showTranslation"></ion-toggle>

      <ion-label>Tefsir</ion-label>
      <ion-toggle [(ngModel)]="showTafsir"></ion-toggle>
    </ion-item>
  </ion-list>
</ion-header>

<ion-content>
  <ion-slides #slides pager="false" [options]="slideOpts"
    (ionSlideNextEnd)="onSuraChanged(+quranService.currentPage + 1)"
    (ionSlidePrevEnd)="onSuraChanged(+quranService.currentPage - 1)" (ionSlideReachStart)="slideTo(1)"
    (ionSlideReachEnd)="slideTo(1)">
    <ion-slide>
      <div dir="ltr" lang="eng" class="translation-wrapper">
        <div [id]="i" [class.blur]="selectedAyah != item.index && mediaPlayerService.isPlaying"
          [class.active]="selectedAyah == item.index" class="ayah"
          *ngFor="let item of translationForCurrentPage; let i = index">
          <ion-progress-bar
            *ngIf="selectedAyah == item.index && (mediaPlayerService.isPlaying || mediaPlayerService.isPaused)"
            color="light" [value]="mediaPlayerService.currentTime/mediaPlayerService.getPlayerDuration()">
          </ion-progress-bar>

          <div class="player"
          *ngIf="selectedAyah == item.index || (!mediaPlayerService.isPlaying || mediaPlayerService.isPaused)">
          <ion-icon *ngIf="!mediaPlayerService.isPlaying && !mediaPlayerService.isPaused"
            (click)="playAyah(item.index);" name="play"></ion-icon>
          <!--scrollToElement(i)-->
          <ion-icon *ngIf="mediaPlayerService.isPlaying && !mediaPlayerService.isPaused"
            (click)="mediaPlayerService.stopAudio(); selectedAyah = null" name="stop"></ion-icon>
        </div>
          <section *ngIf="item.aya == 1" class="suraTitle">
            <img src="https://salamquran.com/static/images/quran/sura-header.svg" alt="Quran sura title">
            <h3>{{quranService.suraList[(+item.sura)-1]?.name}} - {{quranService.suraList[(+item.sura)-1]?.tname}}</h3>
          </section>

          <div class="verse_key" *ngIf="(showArabic || showTranslation || showTafsir) && item.aya != 1">

            <p *ngIf="suraList">Sura {{quranService.suraList[(+item.sura)-1]?.tname}}: {{item.aya}}. ajet</p>
          </div>

          <div class="arabic_text" *ngIf="showArabic">
            <img [src]="'http://cdn.alquran.cloud/media/image/'+item.sura+'_'+item.aya" alt="">
          </div>

          <div class="item" *ngIf="showTranslation">
            <span>Prijevod:</span>
            <p class="translation">{{item.translation}}</p>
          </div>

          <div class="item" *ngIf="showTafsir">
            <span>Tefsir:</span>
            <p class="tafsir">{{item.tafsir}}</p>
          </div>
          <p class="end"></p>
        </div>
      </div>
    </ion-slide>
  </ion-slides>
  <p style="text-align: center;">{{quranService.currentPage}}</p>

</ion-content>
